//! 形状に関するトレイト (Shape, Ndim)

// ============================================================================
// Shape (形状取得)
// ============================================================================

/// テンソルの形状を取得するトレイト
pub trait Shape {
    /// 形状を取得（各次元のサイズ）
    fn shape(&self) -> &[usize];
}

// ============================================================================
// Ndim (次元数取得)
// ============================================================================

/// テンソルの次元数を取得するトレイト
pub trait Ndim {
    /// 次元数を取得
    fn ndim(&self) -> usize;
}

/// Shape を実装している型に対して自動的に Ndim を実装
impl<T: Shape> Ndim for T {
    fn ndim(&self) -> usize {
        self.shape().len()
    }
}

// ============================================================================
// スカラー型への実装
// ============================================================================

impl Shape for f32 {
    fn shape(&self) -> &[usize] {
        &[] // 0次元（スカラー）
    }
}

impl Shape for f64 {
    fn shape(&self) -> &[usize] {
        &[] // 0次元（スカラー）
    }
}
